# Bez Komprese Fan App

Fanou≈°kovsk√° aplikace pro YouTube kan√°l **Bez Komprese**, vyvinut√° s d≈Ørazem na Mobile First p≈ô√≠stup.

## üåê ≈Ωiv√© Demo

Aplikace bƒõ≈æ√≠ online na adrese: **[https://bezkompreseapp.web.app](https://bezkompreseapp.web.app)**

## ‚ú® Hlavn√≠ Funkce

### üè† Domovsk√° Str√°nka
- **Soci√°ln√≠ Feed**: Automatick√© naƒç√≠t√°n√≠ nejnovƒõj≈°√≠ch p≈ô√≠spƒõvk≈Ø z YouTube, Instagramu a Facebooku
- **P≈ôehledn√© Karty**: Zobrazen√≠ vide√≠, reel≈Ø a post≈Ø s n√°hledem a statistikami
- **üÜï Sd√≠len√≠**: Mo≈ænost zkop√≠rovat odkaz nebo pou≈æ√≠t nativn√≠ sd√≠len√≠ u ka≈æd√©ho p≈ô√≠spƒõvku

### üöó Moje Gar√°≈æ
- **Spr√°va Vozidel**: P≈ôid√°v√°n√≠ a editace vlastn√≠ch aut s detailn√≠mi informacemi
- **Fotogalerie**: A≈æ 4 fotky na auto s automatickou kompres√≠ (max 15 MB)
- **Tuning & √öpravy**: Sledov√°n√≠ v≈°ech modifikac√≠ a vylep≈°en√≠
- **Historie Vlastnictv√≠**: Oznaƒçen√≠ aut, kter√° ji≈æ nevlastn√≠te
- **üÜï Statusy Aut**: Barevn√© odznaky pro auta (daily, sez√≥nn√≠, v renovaci, atd.)
- **üÜï Servisn√≠ Kn√≠≈æka**: Kompletn√≠ digit√°ln√≠ evidence servisu
- **üÜï Digit√°ln√≠ Kasl√≠k**: Sledov√°n√≠ platnosti STK, l√©k√°rniƒçky, d√°lniƒçn√≠ zn√°mky a poji≈°tƒõn√≠ (upozornƒõn√≠ p≈ôedem)
- **üÜï Tankov√°n√≠ a Statistiky**: Inteligentn√≠ k≈ô√≠≈æov√Ω v√Ωpoƒçet hodnot (litry/cena), grafy spot≈ôeby, n√°klady palivo vs servis, cena za km, automatick√° synchronizace tachometru (voliteln√© u ƒç√°steƒçn√©ho tankov√°n√≠)

### üîß Servisn√≠ Kn√≠≈æka (NOV√â!)
- **Digit√°ln√≠ Evidence**: Sledov√°n√≠ v≈°ech servisn√≠ch z√°sah≈Ø a oprav
- **Rychl√© ≈†ablony**: P≈ôedvyplnƒõn√© formul√°≈ôe pro bƒõ≈æn√© operace (olej, brzdy, pneumatiky)
- **N√°kladov√° Anal√Ωza**: Grafy celkov√Ωch n√°klad≈Ø a pr≈Ømƒõrn√Ωch mƒõs√≠ƒçn√≠ch v√Ωdaj≈Ø
- **Upom√≠nky**: Automatick√© p≈ôipom√≠nky nadch√°zej√≠c√≠ho servisu podle km nebo data (vƒçetnƒõ inteligentn√≠ detekce **servisu po term√≠nu** s t√Ωdenn√≠m opakov√°n√≠m)
- **Evidence D√≠l≈Ø**: Detailn√≠ seznam pou≈æit√Ωch d√≠l≈Ø a materi√°lu
- **Timeline**: Chronologick√Ω p≈ôehled cel√© historie servisu

### üìÖ Kalend√°≈ô Akc√≠
- **Ofici√°ln√≠ Akce**: P≈ôehled nadch√°zej√≠c√≠ch sraz≈Ø a event≈Ø
- **Komunitn√≠ Srazy**: Mo≈ænost vytvo≈ôit vlastn√≠ sraz
- **Mapa**: Zobrazen√≠ akc√≠ na interaktivn√≠ mapƒõ
- **üÜï Detaily**: Informace o m√≠stƒõ, ƒçase a organiz√°torovi vƒçetnƒõ navigace a mapy
- **üÜï Spr√°va akc√≠**: Organiz√°to≈ôi mohou sv√© akce upravovat nebo mazat (omezeno na budouc√≠ akce)
- **üÜï √öƒçast na akc√≠ch**: Tlaƒç√≠tko "Z√∫ƒçastn√≠m se" s ukl√°d√°n√≠m do datab√°ze
- **üÜï Diskuze pod akc√≠**: Koment√°≈ôe a diskuze p≈ô√≠mo u ka≈æd√© akce

### üë• Komunita
- **Profily U≈æivatel≈Ø**: Zobrazen√≠ gar√°≈æe a aktivit ostatn√≠ch ƒçlen≈Ø (vƒçetnƒõ mo≈ænosti **odhl√°≈°en√≠** v nastaven√≠)
- **Seznam U≈æivatel≈Ø**: Proch√°zen√≠ komunity s p≈ôehledem **TOP 5 nejobl√≠benƒõj≈°√≠ch ƒçlen≈Ø** (dle poƒçtu p≈ô√°tel) a n√°hodn√Ω v√Ωbƒõr dal≈°√≠ch petrolhead≈Ø
- **üÜï Efektivn√≠ Vyhled√°v√°n√≠**: Optimalizovan√© vyhled√°v√°n√≠ u≈æivatel≈Ø (p≈ôes `prefix searchKeys`) s vyhled√°v√°n√≠m dle souƒçasn√©ho i p≈Øvodn√≠ho jm√©na a bleskov√Ωm naƒç√≠t√°n√≠m.
- **Ve≈ôejn√© Gar√°≈æe**: Inspirace od ostatn√≠ch aut√≠ƒçk√°≈ô≈Ø
- **üÜï Syst√©m Odznak≈Ø**: Komplexn√≠ syst√©m sb√≠r√°n√≠ unik√°tn√≠ch odznak≈Ø za aktivitu (BK Team Badge, High Miler, Wrench Wizard a.j.) s transakƒçn√≠m p≈ôipisov√°n√≠m a retroaktivn√≠ kontrolou.
- **üÜï Pokroƒçil√© Statistiky**: Rychl√Ω p≈ôehled celkov√©ho poƒçtu zaregistrovan√Ωch u≈æivatel≈Ø a spravovan√Ωch vozidel nap≈ô√≠ƒç aplikac√≠ (v sekci Info).
- **üöÄ V√Ωkonn√© Proch√°zen√≠**: Serverov√© str√°nkov√°n√≠ a filtrov√°n√≠ v≈°ech aut pro bleskov√© naƒç√≠t√°n√≠ i p≈ôi tis√≠c√≠ch vozidlech

### üìç Live Tracker (NOV√â!)
- **Real-time Mapa**: Zobrazen√≠ polohy ostatn√≠ch u≈æivatel≈Ø v re√°ln√©m ƒçase (**hybridn√≠ podpora pro Safari/Chrome na iOS**)
- **Bƒõh na pozad√≠**: Foreground Sledov√°n√≠ polohy s permanentn√≠ notifikac√≠ i p≈ôi zamknut√©m telefonu (p≈ôi udƒõlen√©m povolen√≠ V≈ædy).
- **Proximity Alerts**: Lok√°ln√≠ klientsk√© notifikace na okoln√≠ u≈æivatele podle nastaviteln√©ho r√°diusu (1-100 km) k zabr√°nƒõn√≠ spamov√°n√≠.
- **Privacy Z√≥ny**: Automatick√© skryt√≠ polohy v bl√≠zkosti domova
- **Statusy**: Nastaven√≠ statusu (D√°me pokec?, Z√°vod?, Proj√≠≈æƒèka?, atd.)
- **üÜò Help Beacon**: S.O.S. syst√©m pro nouzov√© situace
  - Plovouc√≠ S.O.S. tlaƒç√≠tko na mapƒõ
  - 5 typ≈Ø probl√©m≈Ø (porucha, pr√°zdn√° n√°dr≈æ, nehoda, defekt, jin√©)
  - Pulsuj√≠c√≠ ƒçerven√Ω marker viditeln√Ω do 50 km
  - Tlaƒç√≠tko "Jedu pomoct!" pro ostatn√≠ u≈æivatele
  - Mo≈ænost p≈ôidat popis situace
  - Sledov√°n√≠ stavu (aktivn√≠, pomoc na cestƒõ, vy≈ôe≈°eno)

### üè™ Bazar a Marketplace (NOV√â!)
- **üÜï T≈ô√≠-tabov√Ω layout**: P≈ôenastaven√≠ bazaru na sekce "Prodej aut", "Popt√°vky" a "Nab√≠dky" pro lep≈°√≠ p≈ôehlednost
- **üÜï Unified Grid**: Sjednocen√© zobrazen√≠ aut z gar√°≈æe i samostatn√Ωch inzer√°t≈Ø v jednom feedu
- **üÜï Samostatn√© Inzer√°ty**: Mo≈ænost prodat auto i bez nutnosti m√≠t ho v aplikaci v gar√°≈æi
- **üÜï Detail Inzer√°tu**: Nov√° detailn√≠ str√°nka pro ka≈æd√Ω inzer√°t s velkou galeri√≠ a **nativn√≠m sd√≠len√≠m p≈ôes syst√©mov√© rozhran√≠**
- **üÜï Navigace**: Chytr√© p≈ôesmƒõrov√°n√≠ (samostatn√Ω inzer√°t vs detail auta v gar√°≈æi)
- **üÜï Workflow Prodeje**: Mo≈ænost oznaƒçit st√°vaj√≠c√≠ auto z gar√°≈æe jako "Prodan√©" ‚Äì aplikace jej archivuje pod kapotu a souƒçasnƒõ st√°hne aktivn√≠ inzer√°t i prod√°van√Ω status.
- **Vizu√°ln√≠ Opravy**: Sjednocen√© a vrstven√© ≈°t√≠tky u inzer√°t≈Ø (p≈ôedch√°zen√≠ p≈ôekryvu)

### üîî Push Notifikace (NOV√â!)
- **SOS Upozornƒõn√≠**: Okam≈æit√° notifikace p≈ôi vol√°n√≠ o pomoc
- **Koment√°≈ôe k akc√≠m**: Notifikace o nov√Ωch koment√°≈ô√≠ch u akc√≠, kter√Ωch se √∫ƒçastn√≠te
- üë§ **Profil a P≈ô√°tel√©**: Spr√°va vlastn√≠ho gar√°≈æov√©ho st√°n√≠, sledov√°n√≠ p≈ô√°tel a sb√≠r√°n√≠ odznak≈Ø.
- ‚ú® **Onboarding Wizard**: Modern√≠ √∫vodn√≠ pr≈Øvodce pro nov√© u≈æivatele s integrac√≠ opr√°vnƒõn√≠.
- üîî **Chytr√© Notifikace**: Push ozn√°men√≠ pro chat, SOS, nov√© akce a p≈ôipom√≠nky (STK, servis).l√≠k**: Upozornƒõn√≠ na vypr≈°en√≠ STK, l√©k√°rniƒçky, poji≈°tƒõn√≠ nebo d√°lniƒçn√≠ zn√°mky
- **üÜï Chat s u≈æivateli**: Re√°ln√Ω chat mezi ƒçleny komunity s n√°hledy konverzac√≠, histori√≠ a **mo≈ænost√≠ prokliknout se p≈ô√≠mo na profil u≈æivatele**
- **üÜï Bazar a Marketplace**: Prodej aut p≈ô√≠mo z gar√°≈æe a inzerce popt√°vek po d√≠lech ƒçi servisu
- **Tich√© hodiny**: Nastaviteln√Ω ƒças, kdy notifikace nep≈ôijdou (glob√°ln√≠ vynucen√≠ pro v≈°echny typy kromƒõ SOS)
- **Nativn√≠ nastaven√≠**: P≈ô√≠m√Ω odkaz do syst√©mov√©ho nastaven√≠ notifikac√≠ (v Android aplikaci)
- **üÜï Proaktivn√≠ ≈æ√°dosti**: Inteligentn√≠ syst√©m primer dialog≈Ø p≈ôed OS promptem pro vy≈°≈°√≠ konverzi souhlas≈Ø
- **üÜï Web Push podpora**: Kompletn√≠ zprovoznƒõn√≠ notifikac√≠ pro prohl√≠≈æeƒçe (VAPID + Service Worker)
- **üöÄ Optimalizace**: Serverov√© filtrov√°n√≠ p≈ô√≠jemc≈Ø (onNewEvent) pro √∫sporu Firestore ƒçten√≠ p≈ôi velk√©m poƒçtu u≈æivatel≈Ø
- **üÜï iOS Launch Readiness**: Kompletn√≠ p≈ô√≠prava pro iOS (Bundle ID, Firebase Auth, Push notifikace p≈ôes APNs, Geolocation permissions)

### üé® Design a U≈æivatelsk√Ω Z√°≈æitek (UX)
- **Sjednocen√© UI**: Sjednocen√Ω, elegantn√≠ vizu√°ln√≠ styl hlaviƒçek na v≈°ech hlavn√≠ch str√°nk√°ch (Gar√°≈æ, Bazar, Servisn√≠ kn√≠≈æka, Lid√©, Akce, apod.).
- **N√°hledy Profilovek**: Okam≈æit√Ω vizu√°ln√≠ n√°hled vybran√© profilov√© fotky je≈°tƒõ p≈ôed jej√≠m fin√°ln√≠m odesl√°n√≠m a o≈ôezem.
- **Gesta na mobilech**: Pln√° podpora p≈ôirozen√Ωch navigaƒçn√≠ch gest (nat√≠vn√≠ swipe-back na platformƒõ iOS, inteligentn√≠ handling tlaƒç√≠tka zpƒõt na OS Android).

### üìã Changelog
- V [changelog.md](docs/changelog.md) najdete historii zmƒõn v aplikaci, vƒçetnƒõ ned√°vn√Ωch updat≈Ø NPM bal√≠ƒçk≈Ø a bezpeƒçnostn√≠ch oprav.

### üí° My≈°lenky pro budouc√≠ verze
- V [ideas.md](docs/ideas.md) najdete nƒõkter√© my≈°lenky pro budouc√≠ verze aplikace, kter√© m≈Ø≈æete sami navrhovat.

### üêõ Zn√°m√© Chyby
- V [knownbugs.md](docs/knownbugs.md) najdete seznam zn√°m√Ωch chyb a technick√Ωch probl√©m≈Ø, na kter√Ωch pracujeme.
- V [docs/firestore-indexes-guide.md](docs/firestore-indexes-guide.md) najdete postup pro nastaven√≠ datab√°zov√Ωch index≈Ø.


### ‚öñÔ∏è Pr√°vn√≠ informace a Soukrom√≠ (AKTUALIZOV√ÅNO!)
- **GDPR Kompatibilita**: Kompletn√≠ revize z√°sad zpracov√°n√≠ osobn√≠ch √∫daj≈Ø.
- **Transparentnost**: Jasnƒõ definovan√° pravidla pro Bazar, Tracker a sd√≠len√≠ dat o spot≈ôebƒõ.
- **Kontakt**: P≈ô√≠m√Ω kontakt na spr√°vce √∫daj≈Ø (Jakub Pro≈°ek) pro uplatnƒõn√≠ pr√°v u≈æivatel≈Ø.

## Technologie

*   **Runtime:** Node.js (nebo Bun)
*   **Frontend:** React + Vite
*   **Jazyk:** TypeScript
*   **Logika & Efekty:** [Effect](https://effect.website)
*   **Stylov√°n√≠:** Tailwind CSS
*   **Backend:** Firebase (Auth, Firestore, Storage, Cloud Functions)
*   **Mapy:** Leaflet + OpenStreetMap
*   **Optimalizace**: Mobiln√≠ navigace (Hardware tlaƒç√≠tko zpƒõt pro Android, nativn√≠ swipe-back gesto pro iOS), Image caching (Cache-Control immutable, ImageLoader concurrency limit & circuit breaker, Prioritized loading for cars > avatars, Simplified profile photo pipeline (130x130px WebP) with robust Google fallback & internalization storage optimization), Unified 15MB Image Upload Pipeline (WebP conversion, quality 0.7), Unified visual style for all main page headers, Input sanitation (auto-trim), Fast Initial Auth emission (Stale-while-revalidate), Stable useEffect dependencies (Double-loading prevention), Unified Loading UX (Rotating Logo), Social Feed caching (10min limit), YouTube API optimization (using playlistItems for 100x quota saving), Advanced Code Splitting (Vite manualChunks), Reusable Event Form with runtime validation/cleaning (preventing Firestore invalid-argument errors), Multi-field Array Prefix Search (searchKeys utility for community search), **Native Sharing API integration (@capacitor/share)**


## Jak spustit projekt

1.  Nainstalujte z√°vislosti:
    ```bash
    npm install
    # nebo
    bun install
    ```

2.  Spus≈•te v√Ωvojov√Ω server:
    ```bash
    npm run dev
    # nebo
    bun dev
    ```

3.  Otev≈ôete v prohl√≠≈æeƒçi adresu, kterou vyp√≠≈°e konzole (obvykle `http://localhost:5173`).

## Nastaven√≠ Firebase

Aby aplikace plnƒõ fungovala (p≈ôihla≈°ov√°n√≠, ukl√°d√°n√≠ aut, servisn√≠ kn√≠≈æka), je pot≈ôeba vytvo≈ôit projekt na Firebase.

1.  Jdƒõte na [Firebase Console](https://console.firebase.google.com/).
2.  Vytvo≈ôte nov√Ω projekt "Bez Komprese App".
3.  V sekci **Authentication** zapnƒõte metodu **Google**.
4.  V sekci **Firestore Database** vytvo≈ôte datab√°zi (v test m√≥du).
5.  V sekci **Storage** aktivujte Firebase Storage pro ukl√°d√°n√≠ fotek.
6.  Jdƒõte do **Project Settings** -> General -> Your apps -> Web app -> SDK Setup and Configuration.
7.  Zkop√≠rujte konfiguraƒçn√≠ objekt (`apiKey`, `authDomain`, atd.).
8.  Vytvo≈ôte soubor `.env` podle `.env.example` a vypl≈àte Firebase credentials.

### Firestore Kolekce

Aplikace pou≈æ√≠v√° n√°sleduj√≠c√≠ kolekce:
- `users` - U≈æivatelsk√© profily
- `cars` - Vozidla u≈æivatel≈Ø
- `events` - Komunitn√≠ akce a srazy
- `event-comments` - Koment√°≈ôe k akc√≠m
- `service-records` - Z√°znamy ze servisn√≠ kn√≠≈æky
- `presence` - Real-time poloha u≈æivatel≈Ø pro Live Tracker
- `help-beacons` - S.O.S. sign√°ly pro nouzov√© situace
- `marketplace-listings` - Inzer√°ty v bazaru (popt√°vky, d√≠ly)
- `chats` - Konverzace mezi u≈æivateli

## Struktura projektu

*   `src/services/` - Logika aplikace obalen√° v Effect (AuthService, DataService).
*   `src/pages/` - Jednotliv√© obrazovky (Home, Garage, ServiceBook, Events, Info).
*   `src/components/` - Sd√≠len√© komponenty (Layout, EventMap, Footer).
*   `src/contexts/` - React Context pro zp≈ô√≠stupnƒõn√≠ slu≈æeb.
*   `src/types/` - TypeScript definice (Car, ServiceRecord, AppEvent).
*   `src/lib/` - Utility funkce (imageOptimizer).

## Deployment

Aplikace je automaticky deployov√°na na Firebase Hosting p≈ôi push do main vƒõtve.

Pro manu√°ln√≠ deployment:
```bash
npm run build
firebase deploy
```

## Licence a P≈ôisp√≠v√°n√≠
¬© 2026 Jakub Pro≈°ek. V≈°echna pr√°va vyhrazena.

Zdrojov√Ω k√≥d je zve≈ôejnƒõn za √∫ƒçelem transparentnosti a umo≈ænƒõn√≠ komunitn√≠ho v√Ωvoje (Pull Requests) pro **tuto konkr√©tn√≠ aplikaci**.

- **‚úÖ Povoleno:** Prohl√≠≈æen√≠ k√≥du, uƒçen√≠ se z nƒõj, navrhov√°n√≠ zmƒõn a oprav (Fork + Pull Request) do tohoto repozit√°≈ôe.
- **‚ùå Zak√°z√°no:** Redistribuce, prodej, nebo provozov√°n√≠ upraven√Ωch kopi√≠ aplikace pod vlastn√≠m jm√©nem bez v√Ωslovn√©ho souhlasu autora.

Tento projekt je vytvo≈ôen pro prim√°rnƒõ pro fanou≈°ky kan√°lu Bez Komprese, av≈°ak budeme r√°di za pou≈æit√≠ aplikace k√Ωmkoliv dal≈°√≠m.
